-- ===================================================
-- SCRIPT Táº O TÃNH NÄ‚NG BÃŒNH LUáº¬N & THáº¢ TIM
-- Copy vÃ  cháº¡y trong Supabase SQL Editor
-- ===================================================

-- 1. Báº£ng BÃ¬nh Luáº­n (Comments)
create table if not exists public.gallery_comments (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  image_url text not null, -- ÄÆ°á»ng dáº«n áº£nh dÃ¹ng lÃ m ID Ä‘á»‹nh danh
  content text not null,
  author_name text default 'NgÆ°á»i giáº¥u tÃªn'
);

-- 2. Báº£ng Cáº£m XÃºc (Reactions - Tháº£ tim, like...)
create table if not exists public.gallery_reactions (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  image_url text not null,
  reaction_type text not null -- VÃ­ dá»¥: 'â¤ï¸', 'ğŸ‘', 'ğŸ˜‚'
);

-- 3. Báº­t RLS (Báº£o máº­t)
alter table public.gallery_comments enable row level security;
alter table public.gallery_reactions enable row level security;

-- 4. Policy (Cho phÃ©p ai cÅ©ng xem vÃ  Ä‘Äƒng)
create policy "Public view comments" on public.gallery_comments for select using (true);
create policy "Public post comments" on public.gallery_comments for insert with check (true);

create policy "Public view reactions" on public.gallery_reactions for select using (true);
create policy "Public post reactions" on public.gallery_reactions for insert with check (true);
