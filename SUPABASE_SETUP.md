# H∆∞·ªõng D·∫´n C√†i ƒê·∫∑t Supabase (Chi Ti·∫øt)

ƒê·ªÉ ·ª©ng d·ª•ng ho·∫°t ƒë·ªông ƒë·∫ßy ƒë·ªß c√°c t√≠nh nƒÉng (L·ªùi ch√∫c, Tr·∫Øc nghi·ªám, Upload ·∫£nh), b·∫°n c·∫ßn c·∫•u h√¨nh Supabase theo c√°c b∆∞·ªõc sau.

## 1. Bi·∫øn M√¥i Tr∆∞·ªùng (.env)
T·∫°o file `.env` t·∫°i th∆∞ m·ª•c g·ªëc (`d:\Tet2026\.env`) v√† ƒëi·ªÅn th√¥ng tin d·ª± √°n Supabase c·ªßa b·∫°n:

```env
VITE_SUPABASE_URL=https://your-project-id.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
```

---

## 2. T·∫°o B·∫£ng & C·∫•u H√¨nh Database (SQL)

B·∫°n c√≥ th·ªÉ ch·∫°y to√†n b·ªô c√°c l·ªánh d∆∞·ªõi ƒë√¢y trong **SQL Editor** c·ªßa Supabase Dashboard ƒë·ªÉ t·∫°o b·∫£ng v√† c·∫•p quy·ªÅn m·ªôt l·∫ßn.

1. V√†o **SQL Editor**.
2. Paste to√†n b·ªô code sau v√† nh·∫•n **Run**.

```sql
-- ==========================================
-- 1. B·∫£ng L·ªùi Ch√∫c (Wishes)
-- ==========================================
create table if not exists wishes (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  name text not null,
  message text not null
);

-- B·∫£o m·∫≠t (RLS) cho Wishes
alter table wishes enable row level security;

-- Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi xem v√† g·ª≠i l·ªùi ch√∫c
create policy "Wishes Public Select" on wishes for select using (true);
create policy "Wishes Public Insert" on wishes for insert with check (true);


-- ==========================================
-- 2. B·∫£ng K·∫øt Qu·∫£ Tr·∫Øc Nghi·ªám (Quiz Results)
-- ==========================================
create table if not exists quiz_results (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  name text not null,
  score integer not null,
  total_questions integer default 4
);

-- B·∫£o m·∫≠t (RLS) cho Quiz
alter table quiz_results enable row level security;

-- Cho ph√©p t·∫•t c·∫£ m·ªçi ng∆∞·ªùi xem (n·∫øu c·∫ßn) v√† g·ª≠i k·∫øt qu·∫£
create policy "Quiz Public Select" on quiz_results for select using (true);
create policy "Quiz Public Insert" on quiz_results for insert with check (true);


-- ==========================================
-- 3. B·∫£ng Gallery ·∫¢nh (Cho Upload Background)
-- ==========================================
create table if not exists public.gallery_images (
  id bigint generated by default as identity primary key,
  created_at timestamp with time zone default timezone('utc'::text, now()) not null,
  image_url text not null
);

-- B·∫£o m·∫≠t (RLS) cho Gallery
alter table public.gallery_images enable row level security;

-- Cho ph√©p m·ªçi ng∆∞·ªùi xem ·∫£nh (ƒë·ªÉ hi·ªÉn th·ªã l√™n background)
create policy "Gallery Public View" on public.gallery_images for select using (true);

-- Cho ph√©p m·ªçi ng∆∞·ªùi upload ·∫£nh (ƒë·ªÉ th√™m v√†o background)
create policy "Gallery Public Upload" on public.gallery_images for insert with check (true);
```

---

## 3. C·∫•u H√¨nh Storage (Quan Tr·ªçng cho Upload ·∫¢nh)

ƒê√¢y l√† b∆∞·ªõc b·∫Øt bu·ªôc ƒë·ªÉ t√≠nh nƒÉng "Camera/Upload" ho·∫°t ƒë·ªông.

1. V√†o m·ª•c **Storage** (icon Folder) tr√™n thanh menu tr√°i.
2. Nh·∫•n **Create new bucket**.
3. ƒêi·ªÅn t√™n bucket: `gallery` (**L∆∞u √Ω**: Ph·∫£i ch√≠nh x√°c t√™n n√†y).
4. B·∫≠t tu·ª≥ ch·ªçn **Public bucket** sang ON.
5. Nh·∫•n **Save**.

Sau khi t·∫°o xong bucket, b·∫°n c·∫ßn ch·∫°y th√™m 1 ƒëo·∫°n SQL n·ªØa ƒë·ªÉ cho ph√©p ng∆∞·ªùi d√πng upload v√†o bucket n√†y (v√¨ m·∫∑c ƒë·ªãnh n√≥ ch·∫∑n ghi).

Quay l·∫°i **SQL Editor**, ch·∫°y ƒëo·∫°n n√†y:

```sql
-- Cho ph√©p upload file v√†o bucket 'gallery'
create policy "Allow Public Upload to Gallery"
on storage.objects for insert
with check ( bucket_id = 'gallery' );

-- Cho ph√©p xem file (n·∫øu ch∆∞a b·∫≠t Public)
create policy "Allow Public Select from Gallery"
on storage.objects for select
using ( bucket_id = 'gallery' );
```

## 4. Ki·ªÉm Tra

1. Quay l·∫°i trang web c·ªßa b·∫°n (localhost).
2. T·∫£i l·∫°i trang (F5).
3. B·∫•m v√†o n√∫t **Camera üì∑** (th∆∞·ªùng ·ªü g√≥c m√†n h√¨nh).
4. Ch·ªçn m·ªôt file ·∫£nh v√† upload.
5. N·∫øu th√†nh c√¥ng, th√¥ng b√°o s·∫Ω hi·ªán ra v√† ·∫£nh c·ªßa b·∫°n s·∫Ω xu·∫•t hi·ªán tr√™n background sau v√†i gi√¢y (ho·∫∑c sau khi t·∫£i l·∫°i trang).
